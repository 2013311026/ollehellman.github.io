<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Temperature dependent effective potential 1.1">
    
    <meta name="author" content="Olle Hellman" >
    <meta name="sourcefile" content="">
    <link rel="icon" href="../favicon.png">

    <title>Utility scripts &ndash; TDEP</title>

<!-- <link href="../css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="../css/bootstrap.css" rel="stylesheet"> 
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet"> 
    
    <link href="../css/ollesfixes.css" rel="stylesheet"> 

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    

<!-- adobe typekit thing -->
        <script src="https://use.typekit.net/vpt8bxl.js"></script>
        <script>try{Typekit.load({ async: true });}catch(e){}</script>
  </head>

<body>
<div class="wrapper"><!-- my wrapper to make the footer stick at the bottom -->

<!-- Fixed navbar, defined in macros.html for some reason -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
<div class="navbar-brand"><img style="height:50px; position: relative; left: 0px; top: -10px" src="../media/matematico.png"></div>
                <a class="navbar-brand" href="../index.html">TDEP <small>1.1</small></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <!-- manual thingy -->
            
            <li><a href='../page/index.html'>Manual</a></li>
            
            <!-- programs -->
            
            <li><a href="../lists/programs.html">Programs</a></li>
            
            <!-- API -->
            <li>
            <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="apidropdown">API<span class="caret"></span></a>
            <ul class="dropdown-menu" aria-labelledby="apidropdown">
                
                <li><a href="../lists/files.html">Source Files</a></li>
                
                
                <li><a href="../lists/modules.html">Modules</a></li>
                
                
                <li><a href="../lists/procedures.html">Procedures</a></li>
                
                
                
                <li><a href="../lists/types.html">Derived Types</a></li>
                
            </ul>
            </li>
        </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" style="padding 0" role="search">
        <div class="form-group">
            <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
        </form>
        
        </div>
    </div>
</nav>

<div class="container-fluid">
    
</div>
<div class="jumbotron">
<div class="container-fluid">
  <h3>Utility scripts</h3>
</div>
</div>
<div class="container-fluid">

<div class="row">
    
        <div class="col-sm-3">
        <div class="toc">
            <ul class="nav nav-stacked nav-pills">
            <li role="presentation" class="title"><a href='../page/index.html'>Manual</a></li>
            </ul>
            <ul class="nav nav-stacked nav-pills">
            
                <li role="presentation">
                <a href='../page/./0_installation.html'>Installation</a>
                
                </li>
            
                <li role="presentation" class="disabled">
                <a href='../page/./1_utilities.html'>Utility scripts</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/./9_publications.html'>Publications</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/./files.html'>Files</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/index.html'>Workflows</a>
                
                    <ul class="nav nav-stacked nav-pills">
                      
                <li role="presentation">
                <a href='../page/workflows/minimal_example_1.html'>Minimal example I</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/minimal_example_2.html'>Minimal example II</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/minimal_example_3.html'>Minimal example III</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/minimal_example_4.html'>Minimal example IV</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/minimal_example_5.html'>Minimal example V</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/minimal_example_6.html'>Minimal example VI</a>
                
                </li>
            
                <li role="presentation">
                <a href='../page/workflows/using_the_library.html'>Using the library</a>
                
                </li>
            
                    </ul>
                
                </li>
            
            </ul>
        </div>
        </div>
    
    <div class="col-sm-offset-1 col-sm-6 col-sm-offset-2" id='text'>
        <p>Part of the package is a set of small tools that help with preparing input for post-processing. What they do is to parse output files and prepare intput files according to this <a href="files.html">format</a>. If you understand the format (and it is not particularly complicated), it is easy to generate a parsing script for any code. The minimal requirements are positions, forces and energies. Other quantities are there mostly for reference, and can safely be set to zero.</p>
<h4>VASP</h4>
<p>The scripts <code>process_outcar.py</code> and <code>process_outcar_5.3.py</code> are used to extract information from <a href="https://www.vasp.at">VASP</a> OUTCAR files. The usage is straightforward:</p>
<div class="codehilite"><pre><span></span>process_outcar_5.3.py OUTCAR
</pre></div>


<p>This will create the relevant <a href="files.hmtl">input files</a>. Alternatively, is you used some statistical sampling method and have many VASP simulations that need to be stitched together, use</p>
<div class="codehilite"><pre><span></span>process_outcar_5.3.py *OUTCAR
</pre></div>


<p>That is, the script takes any number of OUTCARs as argument. The script assumes you have used <code>ISIF = 2</code>, since without it forces don't get written.</p>
<h4>Abinit</h4>
<p></p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>Get Antoine to send me his script.</p></div>
<h4>LAMMPS</h4>
<p>LAMMPS does not write anything by default. To get usable output, I make sure to add the following to the input file:</p>
<div class="codehilite"><pre><span></span>units metal

variable          st    equal step
variable          tm    equal step
variable          Et    equal etotal-v_baseline
variable          Ep    equal pe-v_baseline
variable          Ek    equal ke
variable          tmp   equal temp
variable          pr    equal press/10000
variable          sxx   equal pxx/10000
variable          syy   equal pyy/10000
variable          szz   equal pzz/10000
variable          sxy   equal pxy/10000
variable          sxz   equal pxz/10000
variable          syz   equal pyz/10000

fix statdump all print 100 &quot;<span class="cp">${</span><span class="n">st</span><span class="cp">}</span> <span class="cp">${</span><span class="n">tm</span><span class="cp">}</span> <span class="cp">${</span><span class="n">Et</span><span class="cp">}</span> <span class="cp">${</span><span class="n">Ep</span><span class="cp">}</span> <span class="cp">${</span><span class="n">Ek</span><span class="cp">}</span> <span class="cp">${</span><span class="n">tmp</span><span class="cp">}</span> <span class="cp">${</span><span class="n">pr</span><span class="cp">}</span> <span class="cp">${</span><span class="n">sxx</span><span class="cp">}</span> <span class="cp">${</span><span class="n">syy</span><span class="cp">}</span> <span class="cp">${</span><span class="n">szz</span><span class="cp">}</span> <span class="cp">${</span><span class="n">sxy</span><span class="cp">}</span> <span class="cp">${</span><span class="n">sxz</span><span class="cp">}</span> <span class="cp">${</span><span class="n">syz</span><span class="cp">}</span>&quot; screen no file dump.stat
dump posdump all custom 100 dump.positions xs ys zs
dump forcedump all custom 100 dump.forces fx fy fz
dump_modify posdump format &quot;%20.15e %20.15e %20.15e&quot;
dump_modify forcedump format &quot;%20.15e %20.15e %20.15e&quot;
</pre></div>


<p>The frequency of the dumps and so on can of course be adjusted. Make sure you use <a href="../program/generate_structure.html">generate structure</a> to create the LAMMPS cell file, since it will also create structure input files in the format TDEP needs. These dump files are not exactly the correct format. A small script can rearrange it to the correct format:</p>
<div class="codehilite"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1"># figure out how many atoms there are</span>
<span class="nv">na</span><span class="o">=</span><span class="sb">`</span>head -n <span class="m">4</span> dump.forces <span class="p">|</span> tail -n <span class="m">1</span><span class="sb">`</span>
<span class="c1"># remove the header from the stat file</span>
grep -v <span class="s1">&#39;^#&#39;</span> dump.stat &gt; infile.stat
<span class="c1"># figure out how many timesteps there are</span>
<span class="nv">nt</span><span class="o">=</span><span class="sb">`</span>wc -l infile.stat <span class="p">|</span> awk <span class="s1">&#39;{print $1}&#39;</span><span class="sb">`</span>

<span class="c1"># create the positions and force files</span>
<span class="o">[</span> -f infile.forces <span class="o">]</span> <span class="o">&amp;&amp;</span> rm infile.forces
<span class="o">[</span> -f infile.positions <span class="o">]</span> <span class="o">&amp;&amp;</span> rm infile.positions
<span class="k">for</span> t in <span class="sb">`</span>seq <span class="m">1</span> <span class="si">${</span><span class="nv">nt</span><span class="si">}</span><span class="sb">`</span>
<span class="k">do</span>
    <span class="nv">nl</span><span class="o">=</span><span class="k">$((</span> <span class="si">${</span><span class="nv">na</span><span class="si">}</span><span class="o">+</span><span class="m">9</span><span class="k">))</span>
    <span class="nv">nll</span><span class="o">=</span><span class="k">$((</span> <span class="si">${</span><span class="nv">nl</span><span class="si">}</span><span class="o">*</span><span class="si">${</span><span class="nv">t</span><span class="si">}</span> <span class="k">))</span>
    <span class="nb">echo</span> <span class="s2">&quot;t </span><span class="si">${</span><span class="nv">t</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">nl</span><span class="si">}</span><span class="s2"> </span><span class="si">${</span><span class="nv">nll</span><span class="si">}</span><span class="s2">&quot;</span>
    head -n <span class="si">${</span><span class="nv">nll</span><span class="si">}</span> dump.forces <span class="p">|</span> tail -n <span class="si">${</span><span class="nv">na</span><span class="si">}</span> &gt;&gt; infile.forces
    head -n <span class="si">${</span><span class="nv">nll</span><span class="si">}</span> dump.positions <span class="p">|</span> tail -n <span class="si">${</span><span class="nv">na</span><span class="si">}</span> &gt;&gt; infile.positions
<span class="k">done</span>
</pre></div>


<p>There are probably far better ways of doing this, happy to take any suggestions.</p>
    </div>
</div>


    <br>
    <br>
</div> <!-- /container -->

</div><!-- end of wrapper -->

<div class="footer">
<div class="container"> 
        <br>
        <div class="row">
            <div class="col-md-4">&copy; 2018 </div>
            <div class="col-md-4"><span class="text-center"> TDEP was developed by Olle Hellman & Nina Shulumba</span></div>
            <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
        <br>
</div>
</div>

    <!-- Bootstrap core JavaScript -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
    <!-- MathJax JavaScript -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
            TeX: { 
                extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], 
                equationNumbers: { autoNumber: 'AMS' } 
            },
            jax: ['input/TeX','input/MathML','output/HTML-CSS'],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            'HTML-CSS': { 
                styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
            }
        });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
