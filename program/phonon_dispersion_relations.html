<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	 
	 <meta name="description" content="Temperature dependent effective potential 1.1">
    
    <meta name="author" content="Olle Hellman" >
    <link rel="icon" href="../favicon.png">

    <title>
    
        phonon dispersion relations &ndash; TDEP
    
</title>

<!-- <link href="../css/bootstrap.min.css" rel="stylesheet"> -->
    <link href="../css/bootstrap.css" rel="stylesheet"> 
    <link href="../css/ollesfixes.css" rel="stylesheet"> 
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet"> 
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
  </head>

<body>
<div class="wrapper"><!-- my wrapper to make the footer stick at the bottom -->

<!-- Fixed navbar, defined in macros.html for some reason -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container-fluid">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
<div class="navbar-brand"><img style="height:50px; position: relative; left: 0px; top: -10px" src="../media/matematico.png"></div>
            <a class="navbar-brand" href="../index.html">TDEP <small>1.1</small></a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
            <!-- manual thingy -->
            
            <li><a href='../page/index.html'>Manual</a></li>
            
            <!-- programs -->
            <li>
            <a class="dropdown-toggle" data-toggle="dropdown" href="programs.html" id="programdropdown">Programs<span class="caret"></span></a>
            <ul class="dropdown-menu" aria-labelledby="apidropdown">
                
                    <li>
                        
                            <a href="../program/atomic_distribution.html">atomic distribution</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/canonical_configuration.html">canonical configuration</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/crystal_structure_info.html">crystal structure info</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/extract_forceconstants.html">extract forceconstants</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/generate_structure.html">generate structure</a>
                        
                     </li>
                
                    <li>
                        
                            <a href='../program/lineshape.html'>lineshape</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/phonon_dispersion_relations.html">phonon dispersion relations</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/samples_from_md.html">samples from md</a>
                        
                     </li>
                
                    <li>
                        
                            <a href="../program/thermal_conductivity.html">thermal conductivity</a>
                        
                     </li>
                
            </ul>
            </li>
            <!-- API -->
            <li>
            <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="apidropdown">API<span class="caret"></span></a>
            <ul class="dropdown-menu" aria-labelledby="apidropdown">
                
                <li><a href="../lists/files.html">Source Files</a></li>
                
                
                <li><a href="../lists/modules.html">Modules</a></li>
                
                
                <li><a href="../lists/procedures.html">Procedures</a></li>
                
                
                
                <li><a href="../lists/types.html">Derived Types</a></li>
                
            </ul>
            </li>
        </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
            <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
        </form>
        
        </div>
    </div>
</nav>

<div class="container-fluid">
    


</div>

<div class="jumbotron">
<div class="container-fluid">
    
        <h3>phonon dispersion relations</h3>
    
</div>
</div>

<div class="container-fluid">
  <div class="row">
    <div class="col-sm-offset-2 col-sm-7 col-sm-offset-3" id='text'>
    <h3>Short description</h3>
<p>Calculate phonon dispersions and related quantities. Per default, only the dispersions along a default path will be calculated. Options are available for calculating mode gruneisen parameters, phonon density of states projected in a variety of ways, thermodynamic quantities and pure data dumps.</p>
<h3>Command line options:</h3>
<p>Optional switches:</p>
<ul>
<li>
<p><code>--unit value</code>, value in: <code>thz,mev,icm</code><br>
    default value thz<br>
    Choose the output unit. The options are terahertz (in frequency, not angular frequency), inverse cm or meV.</p>
</li>
<li>
<p><code>--nq_on_path value</code>, <code>-nq value</code><br>
    default value 100<br>
    Number of q-points between each high symmetry point</p>
</li>
<li>
<p><code>--readpath</code>, <code>-rp</code><br>
    default value .false.<br>
    Read the q-point path from <code>infile.qpoints_dispersion</code>. Use <a href="crystal_structure_info.html">crystal structure into</a> to generate an example.</p>
</li>
<li>
<p><code>--dos</code><br>
    default value .false.<br>
    Calculate the phonon DOS</p>
</li>
<li>
<p><code>--qpoint_grid value#1 value#2 value#3</code>, <code>-qg value#1 value#2 value#3</code><br>
    default value 26 26 26<br>
    Density of q-point mesh for Brillouin zone integrations.</p>
</li>
<li>
<p><code>--meshtype value</code>, value in: <code>1,2,3</code><br>
    default value 1<br>
    Type of q-point mesh. 1 Is a Monkhorst-Pack mesh, 2 an FFT mesh and 3 my fancy wedge-based mesh with approximately the same density the grid-based meshes.</p>
</li>
<li>
<p><code>--sigma value</code><br>
    default value 1.0<br>
    Global scaling factor for the Gaussian/adaptive Gaussian smearing. The default is determined procedurally, and scaled by this number.</p>
</li>
<li>
<p><code>--readqmesh</code><br>
    default value .false.<br>
    Read the q-point mesh from file. To generate a q-mesh file, see the genkpoints utility.</p>
</li>
<li>
<p><code>--integrationtype value</code>, <code>-it value</code>, value in: <code>1,2,3,4</code><br>
    default value 2<br>
    Type of integration for the phonon DOS. 1 is Gaussian, 2 adaptive Gaussian and 3 Tetrahedron.</p>
</li>
<li>
<p><code>--dospoints value</code><br>
    default value 400<br>
    Number of points on the frequency axis of the phonon dos.</p>
</li>
<li>
<p><code>--temperature value</code><br>
    default value -1<br>
    Evaluate thermodynamic phonon properties at a single temperature.</p>
</li>
<li>
<p><code>--temperature_range value#1 value#2 value#3</code><br>
    default value -1 -1 -1<br>
    Evaluate thermodynamic phonon properties for a series of temperatures, specify min, max and the number of points.</p>
</li>
<li>
<p><code>--gruneisen</code><br>
    default value .false.<br>
    Use third order force constants to calculate mode Gruneisen parameters.</p>
</li>
<li>
<p><code>--dumpgrid</code><br>
    default value .false.<br>
    Write files with q-vectors, frequencies, eigenvectors and group velocities for a grid.</p>
</li>
<li>
<p><code>--help</code>, <code>-h</code><br>
    Print this help message</p>
</li>
<li>
<p><code>--version</code>, <code>-v</code><br>
    Print version</p>
</li>
</ul>
<h3>Examples</h3>
<p><code>phonon_dispersion_relations</code> </p>
<p><code>phonon_dispersion_relations --dos -qgrid 24 24 24 -loto --integrationtype 2</code> </p>
<p>This code calculates the phonon dispersions, $ \omega(\mathbf{q}) $. It can output dispersions along a line in the Brillouin zone, output frequencies on a grid, or calculate the phonon DOS. In addition it can calculate the mode Gr√ºneisen parameters. By default, minimal input is needed, but many options to tailor the output exist.</p>
<h3>Equations of motion in a harmonic crystal</h3>
<p>As detailed in <a href="extract_forceconstants.html">extract forceconstants</a> we have mapped the Born-Oppenheimer to an effective potential. A model Hamiltonian truncated at the second order (a harmonic Hamiltonian) is given by<sup id="fnref-Born1998"><a class="footnote-ref" href="#fn-Born1998">1</a></sup></p>
<p>$$
\begin{equation}
\hat H=\sum_{\kappa} \frac{\mathbf{p}_{\kappa}^2}{2m_{\kappa}} + \frac{1}{2} \sum_{\kappa\lambda}\sum_{\alpha\beta}  \Phi_{\kappa\lambda}^{\alpha\beta} u^{\alpha}_{\kappa} u^{\beta}_{\lambda}\,
\end{equation}
$$</p>
<p>Where $\kappa,\lambda$ are indices to atoms, $\alpha,\beta$ Cartesian indices and $\mathbf{u}$ a displacement from equilibrium positions. To clarify, the instantaneous position of an atom is given by</p>
<p>$$
\begin{equation}
\mathbf{r}_{\kappa} = \mathbf{R}_{\mu} + \boldsymbol{\tau}_{i} + \mathbf{u}
\end{equation}
$$</p>
<p>such that $\mathbf{R} +\boldsymbol{\tau}$ denote the equilibrium position of the atom. The lattice vector $\mathbf{R}$ locate the unit cell, $\boldsymbol{\tau}$ locate the atom in the unit cell, and $\mathbf{u}$ how far the atom has moved from the reference positions. Ignoring surface effects, we can write the equations of motion:</p>
<p>$$
\begin{equation}
\ddot{\mathbf{u}}_{\mu i} m_{\mu i} =
-\sum_{\nu j} \mathbf{\Phi}_{\mu i,\nu j}\mathbf{u}_{\nu j} \,.
\end{equation}
$$</p>
<p>Here we expanded the atom index $\kappa$ to the double index indicating cell $\mu$ and position $i$. Since we deal with infinite crystals with periodic boundary conditions, the equations of motion will not depend on cell index $\mu$, and that index can be dropped.</p>
<p>$$
\begin{equation}\label{eq:eqmotion1}
\ddot{\mathbf{u}}_{i} m_{i} =
-\sum_{\nu j} \mathbf{\Phi}_{\mu i,\nu j}\mathbf{u}_{\nu j}.
\end{equation}
$$</p>
<p>I prefer a truncated notation:</p>
<p>$$
\begin{equation}
\ddot{\mathbf{u}}_{i} m_{i} =
-\sum_{\mathbf{R}} \mathbf{\Phi}_{ij}\left( \mathbf{R} \right)\mathbf{u}_{j}.
\end{equation}
$$</p>
<p>Where $\mathbf{R}$ implies the cell index corresponding to atom $j$. To solve these equations of motion, we can use a plane-wave ansatz:</p>
<p>$$
\begin{equation}
\mathbf{u}_{i}=\frac{1}{\sqrt{m_i}} \sum_{\mathbf{q}} A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \left(\mathbf{q} \cdot \mathbf{R} - \omega t \right) }.
\end{equation}
$$</p>
<p>Here the displacements are expressed as a sum of plane waves, or normal modes, each with wave vector $\mathbf{q}$ and frequency $\omega$. $\boldsymbol{\epsilon}$ is a polarisation vector, and $A_{\mathbf{q}}$ the normal mode amplitude. Substituting this into $\eqref{eq:eqmotion1}$ and exploiting the orthogonality of planes waves gives,</p>
<p>$$
\begin{split}
\sqrt{m_i}\sum_{\mathbf{q}} \omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \left(\mathbf{q} \cdot \mathbf{R}_i - \omega t \right) }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}}
\frac{A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}}{\sqrt{m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \left(\mathbf{q} \cdot \mathbf{R}_j - \omega t \right) } \\
%
%
\sum_{\mathbf{q}} \omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i} e^{ i \mathbf{q} \cdot \mathbf{R}_i }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}}
\frac{A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}}{\sqrt{m_i m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \mathbf{q} \cdot \mathbf{R}_j } \\
%
%
\sum_{\mathbf{q}'} \omega^2 A_{\mathbf{q}'} \boldsymbol{\epsilon}_{\mathbf{q}'}^{i} e^{ i \mathbf{q}' \cdot \mathbf{R}_i }
e^{ -i \mathbf{q} \cdot \mathbf{R}_i }
= &amp;
\sum_{\mathbf{R}}\sum_{\mathbf{q}'}
\frac{A_{\mathbf{q}'} \boldsymbol{\epsilon}_{\mathbf{q}'}^{i}}{\sqrt{m_i m_j}}
\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)
e^{ i \mathbf{q}' \cdot \mathbf{R}_j }
e^{ -i \mathbf{q} \cdot \mathbf{R}_i } \\
%
%
\omega^2 A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}
= &amp;
A_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}^{i}
\sum_{\mathbf{R}}
\frac{\mathbf{\Phi}_{ij}\left( \mathbf{R}_j \right)}{\sqrt{m_i m_j}}
e^{ i \mathbf{q} \cdot \mathbf{R}_j } \\
%
%
\omega^2_{\mathbf{q}} \boldsymbol{\epsilon}_{\mathbf{q}}= &amp; \mathbf{\Phi}(\mathbf{q}) \boldsymbol{\epsilon}_{\mathbf{q}}\,,
\end{split}
$$</p>
<p>where the periodic boundary conditions limit the choices of $\mathbf{q}$ to a wave vector $\mathbf{q}$ in the first Brillouin zone. The dynamical matrix $\mathbf{\Phi}(\mathbf{q})$ is given by</p>
<p>$$
\begin{equation}
\mathbf{\Phi}(\mathbf{q})=
\begin{pmatrix}
\mathbf{\Phi}_{11}(\mathbf{q}) &amp; \cdots &amp; \mathbf{\Phi}_{N 1}(\mathbf{q}) \\
\vdots &amp; \ddots &amp; \vdots \\
\mathbf{\Phi}_{1N}(\mathbf{q}) &amp; \cdots &amp; \mathbf{\Phi}_{N N}(\mathbf{q}) \\
\end{pmatrix}
\end{equation}
$$</p>
<p>This is the Fourier transform of the mass-weighted force constant matrix, where each $3 \times 3$ submatrix of the full $3N \times 3N$ is given by</p>
<p>$$
\begin{equation}
\mathbf{\Phi}_{ij}(\mathbf{q})=
\sum_{\mathbf{R}}
\frac{ \mathbf{\Phi}_{ij}(\mathbf{R}) }{\sqrt{m_i m_j}}  
e^{i\mathbf{q}\cdot \mathbf{R}} \,.
\end{equation}
$$</p>
<p>The eigenvalues $\omega^2_{\mathbf{q}s}$ and eigenvectors $\boldsymbol{\epsilon}_{\mathbf{q}s}$ of the dynamical matrix denote the possible normal mode frequencies and polarizations of the system. The eigenvalues have the same periodicity as the reciprocal lattice; hence it is convenient to limit the solution to all vectors $\mathbf{q}$ in the first Brillouin zone. It is also worth defining the partial derivatives of the dynamical matrix:</p>
<p>$$
\begin{equation}
\frac{\partial \mathbf{\Phi}_{ij}(\mathbf{q})}{\partial q_\alpha}
=
\sum_{\mathbf{R}}
iR_\alpha
\frac{ \mathbf{\Phi}_{ij}(\mathbf{R}) }{\sqrt{m_i m_j}}  
e^{i\mathbf{q}\cdot \mathbf{R}}.
\end{equation}
$$</p>
<p>By calculating the eigenvalues and eigenvectors of the dynamical matrix over the Brillouin zone, all thermodynamic quantities involving the atomic motions can be determined, as far as the harmonic approximation is valid. If you are curious where the amplitudes of the normal modes disappeared, see <a href="canonical_configuration.html">canonical configuration</a>.</p>
<h3>Long-ranged interactions in polar materials</h3>
<p>When determining the dynamical matrix, the sum over lattice vectors $\mathbf{R}$ should in principle be carried out over all pairs. In practice, we assume that the interactions are zero beyond some cutoff (see <a href="extract_forceconstants.html">extract forceconstants</a> option <code>-rc2</code>), and truncate the sum. This is not a valid approach when dealing with polar material where the induced dipole-dipole interactions are essentially infinite-ranged. See for example Gonze &amp; Lee.<sup id="fnref-Gonze1994"><a class="footnote-ref" href="#fn-Gonze1994">5</a></sup> <sup id="fnref-Gonze1997"><a class="footnote-ref" href="#fn-Gonze1997">6</a></sup> When dealing with these long-ranged electrostatics we start by defining the Born effective charge tensor:</p>
<p>$$
Z_{i}^{\alpha\beta} = \frac{\partial^2 U}{\partial \varepsilon^{\alpha} \partial u_{i}^{\beta}}
$$</p>
<p>That is the mixed derivative of the energy with respect to electric field $\varepsilon$ and displacement $\mathbf{u}$. Displacing an atom from its equilibrium position induces a dipole, given by</p>
<p>$$
\mathbf{d}_{i} = \mathbf{Z}_{i}\mathbf{u}_{i}
$$</p>
<p>The pairwise dipole-dipole interactions can be expressed as forceconstants:</p>
<p>$$
\begin{align}
\Phi^{\textrm{dd}}|^{\alpha\beta}_{ij} &amp; = \sum_{\gamma\delta} Z_{i}^{\alpha\gamma}Z_{j}^{\beta\delta} \widetilde{\Phi}^{\gamma\delta}_{ij} \\
\widetilde{\Phi}^{\alpha\beta}_{ij} &amp; =
\frac{1}{4\pi\epsilon_0}
\frac{1}{\sqrt{\det \epsilon}}
\left(
    \frac
    { \widetilde{\epsilon}^{\alpha\beta} }
    {|\Delta_{ij}|_{\epsilon}^{3}}
    -3 \frac
    {\Delta_{ij}^{\alpha}\Delta_{ij}^{\beta}}
    {|\Delta_{ij}|_{\epsilon}^{5}}
\right)
\end{align}
$$</p>
<p>Here $\boldsymbol{\epsilon}$ is the dielectric tensor, $\widetilde{\boldsymbol{\epsilon}}=\boldsymbol{\epsilon}^{-1}$ its inverse and $\Delta$ realspace distances using the dielectric tensor as a metric:</p>
<p>$$
\begin{align}
\mathbf{r}_{ij} &amp; = \mathbf{R}_{j}+\mathbf{\tau}_j-\mathbf{\tau}_i \\
\mathbf{\Delta}_{ij} &amp; =\widetilde{\boldsymbol{\epsilon}}\mathbf{r}_{ij} \\
|\Delta_{ij}|_{\epsilon} &amp; = \sqrt{\mathbf{\Delta}_{ij} \cdot \mathbf{r}_{ij}}
\end{align}
$$</p>
<p>This poses an issue when calculating the dynamical matrix: the interactions die off as $~1/r^{3}$ which makes it necessary to extend the sum over lattice vectors to infinity. This is remedied with the usual Ewald technique:</p>
<p>$$
\widetilde{\mathbf{\Phi}}_{ij} (\mathbf{q})=
\widetilde{\mathbf{\Phi}}^\textrm{r}+\widetilde{\mathbf{\Phi}}^\textrm{q}+\widetilde{\mathbf{\Phi}}^\textrm{c}
$$</p>
<p>Dividing the sum into a realspace part, a reciprocal part and a connecting part. The realspace part is given by</p>
<p>$$
\begin{align}
\widetilde{\mathbf{\Phi}}^\textrm{r}_{ij} &amp; =
-\frac{\Lambda^3}{4\pi\epsilon_0\sqrt{\det \epsilon}}
\sum_{\mathbf{R}}
\mathbf{H}(\Lambda \Delta_{ij},\Lambda|\Delta_{ij}|_{\epsilon})
e^{i \mathbf{q} \cdot \mathbf{R}} \\
%%
\frac{\partial \widetilde{\mathbf{\Phi}}^\textrm{r}_{ij}}{\partial q_\alpha}  &amp; =
-\frac{\Lambda^3}{4\pi\epsilon_0\sqrt{\det \epsilon}}
\sum_{\mathbf{R}}
iR_\alpha
\mathbf{H}(\Lambda \Delta_{ij},\Lambda|\Delta_{ij}|_{\epsilon})
e^{i \mathbf{q} \cdot \mathbf{R}}
\end{align}
$$</p>
<p>where</p>
<p>$$
H_{\alpha\beta}(\mathbf{x},y) = \frac{x_{\alpha}x_{\beta} }{y^2}
\left[
\frac{3\,\textrm{erfc}\,y}{y^3}
+
\frac{2 e^{-y^2}}{\sqrt{\pi}}\left(\frac{3}{y^2}+2 \right)
\right]
-\widetilde{\epsilon}_{\alpha\beta}
\left[
\frac{\textrm{erfc}\,y}{y^3} + \frac{2 e^{-y}}{\sqrt{\pi} y^2 }
\right]\,.
$$</p>
<p>In reciprocal space we have</p>
<p>$$
\begin{align}
%
% Not derivative
%
    \widetilde{\Phi}_\textrm{q}|_{ij}
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right) \\
%
% X-direction
%
    \frac{\partial}{\partial q_x} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^x_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha x}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    2K_x &amp; K_y &amp; K_z \\
    K_y &amp; 0 &amp; 0 \\
    K_z &amp; 0 &amp; 0
    \end{pmatrix} \\
%
% Y-direction
%
    \frac{\partial}{\partial q_y} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^y_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha y}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    0 &amp; K_x &amp; 0 \\
    K_y &amp; 2K_y &amp; K_z \\
    0 &amp; K_z &amp; 0
    \end{pmatrix}\\
%
% Z-direction
%
    \frac{\partial}{\partial q_z} \widetilde{\Phi}_\textrm{q}|_{ij}
    %
    &amp;=
    \sum_{\mathbf{K}=\mathbf{G}+\mathbf{q}}
    \chi_{ij}(\mathbf{K},\Lambda)
    \left( \mathbf{K}\otimes\mathbf{K} \right)
    %
    \left(
    i\tau^z_{ij} - \left[\sum_{\alpha} K_\alpha \epsilon_{\alpha z}
    \right]
    \left[ \frac{1}{\|\mathbf{K}\|_{\epsilon}}+\frac{1}{4\Lambda^2} \right]
    \right) +
    %
    \chi_{ij}(\mathbf{K},\Lambda)
    \begin{pmatrix}
    0 &amp; 0 &amp; K_x \\
    0 &amp; 0 &amp; K_y \\
    K_z &amp; K_y &amp; 2K_z
    \end{pmatrix}
\end{align}
$$</p>
<p>where</p>
<p>$$
\begin{align}
\chi_{ij}(\mathbf{K},\Lambda) &amp;  =
\frac{1}{\Omega\epsilon_0}
\frac{
\exp\left(i \mathbf{q} \cdot \mathbf{\tau}_{ij} \right)
\exp\left( -\frac{\|\mathbf{K}\|_{\epsilon}}{4\Lambda^2}  \right)
}
{\|\mathbf{K}\|_{\epsilon}} \\
%%
\|\mathbf{K}\|_{\epsilon} &amp; =\sum_{\alpha\beta}\epsilon_{\alpha\beta}K_\alpha K_\beta
\end{align}
$$</p>
<p>and finally a connecting part given by</p>
<p>$$
\widetilde{\mathbf{\Phi}}_\textrm{c}|_{ij}=
\delta_{ij}
\frac{\Lambda^3}{3 \epsilon_0 \pi^{3/2} \sqrt{ \det \boldsymbol{\epsilon} } }
\widetilde{\boldsymbol{\epsilon}}
$$</p>
<p>This expression is invariant for any $\Lambda&gt;0$, which is chosen to make the real and reciprocal sums converge with as few terms as possible. Note that the Born charges are factored out from $\widetilde{\mathbf{\Phi}}$, and have to by multiplied in as described above. The derivatives with respect to $q$ are reproduced because they are useful when calculating the gradient of the dynamical matrix, needed when determining group velocities. In the long-wavelength limit, $\mathbf{q}\rightarrow 0$, the dipole-dipole dynamical matrix reduces to the familiar non-analytical term:</p>
<p>$$
\lim_{\mathbf{q}\rightarrow 0} \mathbf{\Phi}(\mathbf{q}) =
\frac{1}{\Omega\epsilon_0}
\frac{
\left(\mathbf{Z}_i\mathbf{q}\right) \otimes \left(\mathbf{Z}_j\mathbf{q}\right)
}{\mathbf{q}^T\boldsymbol{\epsilon}\mathbf{q}}
$$</p>
<p>This package implements three different ways of dealing with these long-ranged interactions. For historical reasons, the so-called mixed-space approach is available, but it should not be used except as an example of what not to do.</p>
<p>The technical issue is that the forces from a DFT calculation are not separated cleanly into "electrostatic longrange" and "everything else" components. The TDEP approach allows for two variants to separate this:</p>
<h5>Separation approach 1</h5>
<p>This is the approach proposed by Gonze &amp; Lee<sup id="fnref2-Gonze1997"><a class="footnote-ref" href="#fn-Gonze1997">6</a></sup>, only slightly adjusted since they assumed you start with reciprocal space dynamical matrices, whereas I start with realspace forceconstants. Algorithmically, it works like this:</p>
<ul>
<li>Define a $N_a \times N_b \times N_c$ suprecell, large enough that it snugly fits your realspace forceconstants.</li>
<li>Calculate the electrostatic dynamical matrices on a $N_a \times N_b \times N_c$ $q$-mesh.</li>
<li>Inverse fourier transform the electrostatic dynamical matrices to realspace forceconstants:
$$
\mathbf{\Phi}^{\textrm{dd}}_{ij}(\mathbf{R}) =\frac{ \sqrt{m_i m_j} }{N_a N_b N_c} \sum_{\mathbf{q}}  \Phi^{\textrm{dd}}_{ij}(\mathbf{q}) e^{-i\mathbf{q} \cdot \mathbf{R}}
$$</li>
<li>Subtract these from the realspace forceconstants:
$$
\hat{\mathbf{\Phi}}_{ij}(\mathbf{R})=
\mathbf{\Phi}_{ij}(\mathbf{R})-
\mathbf{\Phi}^{\textrm{dd}}_{ij}(\mathbf{R})
$$</li>
<li>Calculate the dynamical matrix as a sum of the short- and long-ranged contributions:
$$
\mathbf{\Phi}_{ij}(\mathbf{q}) = \hat{\mathbf{\Phi}}_{ij}(\mathbf{R}) + \Phi^{\textrm{dd}}_{ij}(\mathbf{q})
$$</li>
</ul>
<p>At $\mathbf{q}=0$ the non-analytcal contribution has to be added as well. This approach is reasonably robust, and works well in most materials. However, there are some aliasing contributions added since the realspace forceconstants are truncated by distance, and I propose a slight variation of this scheme:</p>
<h5>Separation approach 2</h5>
<p>This idea is similar in spirit, but does the separation into long- and short-ranged interactions at an earlier stage.</p>
<p></p><div class="alert alert-success" role="alert"><h4>Todo</h4><p>Fill this in once published.</p></div>
<h5>Mixed-space approach</h5>
<p>This is implemented for historical reasons and for comparison, but disabled by default. It should not be used for anything, it is incorrect, and doing it right cost nothing.</p>
<h3>Harmonic thermodynamics</h3>
<p>In the previous section, we treated the vibrations of atoms classically, by solving Newton's equations of motion. Quantum-mechanically, vibrational normal modes can be represented as quasi-particles called phonons, quanta of thermal energy. We note that our normal mode transformation is a sum over eigenfunctions of independent harmonic oscillators. This allows us to write the position and momentum operators in terms of creation and annihilation operators (without loss of generality, we can contract the notation for phonon mode $s$ at wave vector $\mathbf{q}$ to a single index $\lambda$):</p>
<p>$$
\begin{align}
\hat{u}_{i\alpha} = &amp; \sqrt{ \frac{\hbar}{2N m_\alpha} }
\sum_\lambda \frac{\epsilon_\lambda^{i\alpha}}{ \sqrt{ \omega_\lambda} }
e^{i\mathbf{q}\cdot\mathbf{r}_i}
\left( \hat{a}^{\mathstrut}_\lambda + \hat{a}^\dagger_\lambda \right) \\
%
\hat{p}_{i\alpha} = &amp; \sqrt{ \frac{\hbar m_\alpha}{2N} }
\sum_\lambda \sqrt{ \omega_\lambda } \epsilon_\lambda^{i\alpha}
e^{i\mathbf{q}\cdot\mathbf{r}_i-\pi/2}
\left( \hat{a}^{\mathstrut}_\lambda - \hat{a}^\dagger_\lambda \right)
%
\end{align}
$$</p>
<p>and their inverse</p>
<p>$$
\begin{align}
\hat{a}^{\mathstrut}_{\lambda} = &amp; \frac{1}{\sqrt{2N\hbar}}
\sum_{i\alpha} \epsilon_\lambda^{i\alpha}
e^{-i\mathbf{q}\cdot\mathbf{r}_i} \left( \sqrt{m_i \omega_\lambda} \hat{u}_{i\alpha}-i \frac{\hat{p}_{i\alpha}}{ \sqrt{ m_i \omega_\lambda }} \right) \\
%
\hat{a}^\dagger_{\lambda} = &amp; \frac{1}{\sqrt{2N\hbar}}
\sum_{i\alpha} \epsilon_\lambda^{i\alpha}
e^{i\mathbf{q}\cdot\mathbf{r}_i} \left( \sqrt{m_i \omega_\lambda} \hat{u}_{i\alpha}-i \frac{\hat{p}_{i\alpha}}{ \sqrt{ m_i \omega_\lambda }} \right)
\end{align}
$$</p>
<p>In terms of these operators, the vibrational Hamiltonian can be written as</p>
<p>$$
\begin{equation}
\hat{H}=\sum_{\lambda}\hbar\omega_\lambda \left( \hat{a}^\dagger_\lambda \hat{a}^{\mathstrut}_\lambda + \frac{1}{2}\right)\,.
\end{equation}
$$</p>
<p>Since $\hat{a}^\dagger_\lambda \hat{a}^{\mathstrut}_\lambda$ are commutative operators, the Hamiltonian is that of a sum of uncoupled harmonic quantum oscillators, each having the partition function</p>
<p>$$
\begin{equation}
Z_{\lambda}=\sum_{n=0}^{\infty}e^{-\beta (n +\frac{1}{2})\hbar\omega_{\lambda} } =
\frac{ e^{-\beta \hbar\omega_{\lambda}/2 } }{1-e^{-\beta \hbar\omega_{\lambda}}}
\end{equation}
$$</p>
<p>that gives the total</p>
<p>$$
\begin{equation}
Z=\prod_{\lambda} \frac{ e^{-\beta \hbar\omega_{\lambda}/2 } }{1-e^{-\beta \hbar\omega_{\lambda}}}.
\end{equation}
$$</p>
<p>From this we can get the Helmholtz (phonon) free energy:</p>
<p>$$
\begin{equation}
F_{\textrm{ph}}= -k_B T \ln Z = \sum_{\lambda} \frac{\hbar \omega_{\lambda}}{2}+k_B T%
\ln \left( 1- \exp \left( -\frac{\hbar \omega_{\lambda}}{k_B T} \right) \right)
\end{equation}
$$</p>
<p>In the conventional quasiharmonic approximation, the total free energy of the system (not considering any terms pertaining to magnetic or configurational degrees of freedom) can be expressed as</p>
<p>$$
\begin{equation}
    F = F_{\textrm{el}} + F_{\textrm{ph}}\,.
\end{equation}
$$</p>
<p>In the TDEP formalism it is not quite that simple.</p>
<h4><a name="sec_tdepthermo"></a> Determining the free energy with TDEP</h4>
<p>In the TDEP formalism,<sup id="fnref-Hellman2013"><a class="footnote-ref" href="#fn-Hellman2013">4</a></sup><sup>,</sup><sup id="fnref-Hellman2013a"><a class="footnote-ref" href="#fn-Hellman2013a">3</a></sup><sup>,</sup><sup id="fnref-Hellman2011"><a class="footnote-ref" href="#fn-Hellman2011">2</a></sup> with effective force constants, the phonon quasiparticles are different at each temperature. At fix temperature, they behave just like normal bosons, obeying Bose-Einstein statistics and so on. But changing the temperature will change both the occupation numbers and the states that are occupied. Moreover, in the harmonic approximation the baseline energy (with all atoms at their equilibrium positions) is that of the static lattice. With an effective Hamiltonian this baseline is a free parameter. The baseline shift is illustrated in the diagram below:</p>
<p><center><img src="../media/explain_U0.png" width="600" /></center></p>
<p>The density depicts the phase space samples used to fit the effective Hamiltonian. The reference energy, or baseline, has been shifted with respect to zero temperature. This baseline is determined by matching the potential energies of the samples of the Born-Oppenheimer surface, $U_{BO}$, and the potential energy of the TDEP model Hamiltonian:</p>
<p>$$
\begin{equation}
\begin{split}
    \left\langle U_{\textrm{BO}} - U_{\textrm{TDEP}} \right\rangle &amp; =
    \left\langle U_{\textrm{BO}} - U_0 -\frac{1}{2} \sum_{ij} \sum_{\alpha\beta} \Phi_{ij}^{\alpha\beta} u^{\alpha}_i u^{\beta}_j  \right\rangle = 0 \\
    U_0 &amp; = \left\langle U_{\textrm{BO}} - \frac{1}{2} \sum_{ij} \sum_{\alpha\beta} \Phi_{ij}^{\alpha\beta} u^{\alpha}_i u^{\beta}_j \right\rangle
\end{split}
\end{equation}
$$</p>
<p>Intuitively, this can be interpreted as that the TDEP force constants are determined by matching forces between the real and model system, in a similar manner we match the energies as well. The new baseline is conveniently expressed as a shift:</p>
<p>$$
\begin{equation}
    \Delta U = U_0-U_{\textrm{stat}}
\end{equation}
$$</p>
<p>Where $U_{\textrm{stat}}$ is the energy of the perfect lattice at 0K. The free energy is then (excluding configurational entropy, magnetic entropy etc.)</p>
<p>$$
\begin{equation}
    F = F_{\textrm{el}} + F_{\textrm{ph}} + \Delta U_0\,.
\end{equation}
$$</p>
<p>The entropy and heat capacity is not accessible from a single simulation. Since both the phonon free energy and baseline shift have non-trivial temperature dependencies, a series of calculations for different temperatures are needed, so that the entropy can be calculated via</p>
<p>$$
\begin{equation}
    S = -\left.\frac{dF}{dT}\right|_V
\end{equation}
$$</p>
<p>A series of calculations on a volume-temperature grid is required to calculate Gibbs free energy, with pressure explicitly calculated as</p>
<p>$$
\begin{equation}
    P = -\left.\frac{dF}{dV}\right|_T
\end{equation}
$$</p>
<h4>Other dispersive properties</h4>
<p>We determine group velocities via the Hellman-Feynmann theorem:</p>
<p>$$
\begin{equation}
    \nabla_{\mathbf{q}} \omega^2_s = \left\langle \epsilon_s(\mathbf{q}) \right| \nabla_{\mathbf{q}} \Phi(\mathbf{q})  \left| \epsilon_s(\mathbf{q}) \right\rangle
\end{equation}
$$</p>
<p>where the derivatives of the dynamical matrix are defined above, and</p>
<p>$$
\begin{equation}
\mathbf{v}_{\mathbf{q}s} = \nabla_{\mathbf{q}} \omega_s(\mathbf{q})=
\frac{1}{2\omega_s} \nabla_{\mathbf{q}} \omega_s^2(\mathbf{q})
\end{equation}
$$</p>
<p>The only complications in using this expression is at wave vectors with degenerate frequencies, in those cases one has to average over the small group of the wave vector to obtain consistent group velocities.</p>
<p>The mode Gr√ºneisen parameters are a measure of the sensitivity of the vibrational frequencies to volume changes. They are given by</p>
<p>$$
\begin{equation}
\gamma_{\mathbf{q}s}=-\frac{V}{\omega_{\mathbf{q}s}}\frac{\partial \omega_{\mathbf{q}s}}{\partial V}
\end{equation}
$$</p>
<p>where $V$ is the volume and $\omega_{\mathbf{q}s}$ is the frequency of mode $s$ at wave vector $\mathbf{q}$. $\gamma_{\mathbf{q}s}$ can be obtained either by numerical differentiation of the phonon dispersion relations or from the third order force constants based on a perturbation approach:</p>
<p>$$
\begin{equation}
\gamma_{\mathbf{q}s}=-\frac{1}{6\omega_{\mathbf{q}s}^2}\sum_{ijk\alpha\beta\gamma}
\frac{\epsilon^{i\alpha\dagger}_{\mathbf{q}s} \epsilon^{j\beta}_{\mathbf{q}s}}
{\sqrt{m_i m_j}}
r_k^\gamma \Phi_{ijk}^{\alpha\beta\gamma}e^{i\mathbf{q}\cdot\ \mathbf{r}_j}
\end{equation}
$$</p>
<p>Here $\epsilon_{i\alpha}^{\mathbf{q}s}$ is component $\alpha$ associated eigenvector $\epsilon$ for atom $i$. $m_i$ is the mass of atom $i$, and $\mathbf{r}_i$ is the vector locating its position.</p>
<h4>Density of states</h4>
<p>Using <code>--dos</code> or <code>--projected_dos_*</code> will calculate the phonon density of states, given by</p>
<p>$$
g_s(\omega) = \frac{(2\pi)^3}{V} \int_{\mathrm{BZ}} \delta( \omega - \omega_{\mathbf{q}s}) d\mathbf{q}
$$</p>
<p>per mode $s$, summing those up yields the total. The site projected density of states for site $i$ is given by</p>
<p>$$
g_i(\omega) = \frac{(2\pi)^3}{V} \sum_{s} \int_{\mathrm{BZ}} \left|\epsilon^i_{\mathbf{q}s}\right|^2 \delta( \omega -  \omega_{\mathbf{q}s}) d\mathbf{q}
$$</p>
<p>that, also sums to the total density of states.</p>
<h3>Input files</h3>
<ul>
<li><a href="../page/files.html#infile.ucposcar">infile.ucposcar</a></li>
<li><a href="extract_forceconstants.html">infile.forceconstant</a></li>
</ul>
<p>Optional files:</p>
<ul>
<li><a href="../page/files.html#infile.qpoints_dispersion">infile.qpoints_dispersion</a> (to specify a path for the phonon dispersions)</li>
<li><a href="../page/files.html#infile.lotosplitting">infile.lotosplitting</a> (including the electrostatic corrections)</li>
<li><a href="extract_forceconstants.html">infile.forceconstant_thirdorder</a> (for the Gr√ºneisen parameter)</li>
</ul>
<h3>Output files</h3>
<p>Depending on options, the set of output files may differ. We start with the basic files that are written after running this code.</p>
<h4><code>outfile.dispersion_relations</code></h4>
<p>This file contains a list of $q$ points (in 1/√Ö) according to the chosen path (default or specified by the user in <code>infile.qpoints_dispersions</code>) and the frequencies per mode (in the specified units via <code>--unit</code>) for the corresponding points.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( q_1 \qquad \omega_1 \qquad \omega_2 \qquad \ldots \qquad \omega_{3N_a} \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( q_2 \qquad \omega_1 \qquad \omega_2 \qquad \ldots \qquad \omega_{3N_a} \)    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Not that the first column is for plotting purposes only. It serves to ensure that each line segment is scaled properly, since each segment contains a fix number of points.</p>
<h4><code>outfile.group_velocities</code></h4>
<p>This file contains the norm of the group velocities as a function of q. Format is identical to that of the dispersions:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( q_1 \qquad |v_1| \qquad |v_2| \qquad \ldots \qquad |v_{3N_a}| \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( q_2 \qquad |v_1| \qquad |v_2| \qquad \ldots \qquad |v_{3N_a}| \) </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in km/s.</p>
<h4><code>outfile.mode_gruneisen_parameters</code></h4>
<p>In case you used <code>--gruneisen</code>, the mode Gr√ºneisen parameters will be written, in a format similar to the dispersions and group velocities:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ q_1 \qquad \gamma_1 \qquad \gamma_2 \qquad \ldots \qquad \gamma_{3N_a} $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ q_2 \qquad \gamma_1 \qquad \gamma_2 \qquad \ldots \qquad \gamma_{3N_a} $  </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in km/s.</p>
<p><a name="outfile.phonon_dos"></a></p>
<h4><code>outfile.phonon_dos</code></h4>
<p>The first column is the list of frequencies and the second column in the density of states for this frequency, given in arbitrary units. Note that integrated density of states is normalized. One can calculate partial density of states (<code>--projected_dos_mode</code>); if the user specifies this option, an extra column will be added into the <code>outfile.phonon_dos</code> file for each type of atom. With <code>--projected_dos_site</code> the same thing happens but with an extra column for each atom in the unit cell.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ \omega_1 \qquad g(\omega_1) \qquad g_1(\omega_1) \qquad \ldots \qquad g_{N}(\omega_1) $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ \omega_2 \qquad g(\omega_2) \qquad g_1(\omega_2) \qquad \ldots \qquad g_{N}(\omega_2) $
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The units are in states per energy unit, depending on choice of <code>--unit</code>. The total DOS normalizes to 3N independent of choice of unit.</p>
<h4><a name="outfile.free_energy"></a> <code>outfile.free_energy</code></h4>
<p>If one chooses the option <code>--temperature_range</code> or <code>--temperature</code> then this file will display a list of temperatures with corresponding temperatures, vibrational free energies, vibrational entropies and heat capacities.</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    $ T_1 \qquad F_{\textrm{vib}} \qquad S_{\textrm{vib}} \qquad C_v $
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    $ T_2 \qquad F_{\textrm{vib}} \qquad S_{\textrm{vib}} \qquad C_v $
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Temperature is given in K, \( F_{\textrm{vib}} \) in eV/atom, \( S_\textrm{vib} \) in eV/K/atom and heat capacity in eV/K/atom.</p>
<h4><code>outfile.mode_vibentropies</code></h4>
<p>Using <code>--modevib</code> gives the mode-projected vibrational entropies:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( T_1 \qquad S_{1} \qquad S_{2} \qquad \ldots \qquad S_{3N_a} \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( T_1 \qquad S_{1} \qquad S_{2} \qquad \ldots \qquad S_{3N_a} \)
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>Where all entropies are in eV/K/atom.</p>
<h4><code>outfile.site_vibentropies</code></h4>
<p>Using <code>--sitevib</code> gives the site-projected vibrational entropies:</p>
<table class='table table-striped'>
<thead><tr>
    <th>Row</th>
    <th>Description</th>
</tr></thead>
<tbody>
<tr>
    <td>1</td>
    <td>
    \( T_1 \qquad S_{1} \qquad S_{2} \qquad \ldots \qquad S_{N_a} \)
    </td>
</tr>
<tr>
    <td>2</td>
    <td>
    \( T_1 \qquad S_{1} \qquad S_{2} \qquad \ldots \qquad S_{N_a} \)
    </td>
</tr>
<tr>
    <td>...</td>
    <td>...</td>
</tr>
</tbody>
</table>

<p>The first column is the temperature, followed by one column per atom. All entropies are in eV/K/atom.</p>
<h4><code>outfile.grid_dispersions.hdf5</code></h4>
<p>Using option <code>--dumpgrid</code> writes all phonon properties for a grid in the BZ to an hdf5 file, that is self-documented.</p>
<div class="footnote">
<hr>
<ol>
<li id="fn-Born1998">
<p>Born, M., &amp; Huang, K. (1964). Dynamical theory of crystal lattices. Oxford: Oxford University Press.&#160;<a class="footnote-backref" href="#fnref-Born1998" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
<li id="fn-Hellman2011">
<p><a href="http://doi.org/10.1103/PhysRevB.84.180301">Hellman, O., Abrikosov, I. A., &amp; Simak, S. I. (2011). Lattice dynamics of anharmonic solids from first principles. Physical Review B, 84(18), 180301.</a>&#160;<a class="footnote-backref" href="#fnref-Hellman2011" title="Jump back to footnote 2 in the text">&#8617;</a></p>
</li>
<li id="fn-Hellman2013a">
<p><a href="http://doi.org/10.1103/PhysRevB.88.144301">Hellman, O., &amp; Abrikosov, I. A. (2013). Temperature-dependent effective third-order interatomic force constants from first principles. Physical Review B, 88(14), 144301.</a>&#160;<a class="footnote-backref" href="#fnref-Hellman2013a" title="Jump back to footnote 3 in the text">&#8617;</a></p>
</li>
<li id="fn-Hellman2013">
<p><a href="http://doi.org/10.1103/PhysRevB.87.104111">Hellman, O., Steneteg, P., Abrikosov, I. A., &amp; Simak, S. I. (2013). Temperature dependent effective potential method for accurate free energy calculations of solids. Physical Review B, 87(10), 104111.</a>&#160;<a class="footnote-backref" href="#fnref-Hellman2013" title="Jump back to footnote 4 in the text">&#8617;</a></p>
</li>
<li id="fn-Gonze1994">
<p><a href="https://link.aps.org/doi/10.1103/PhysRevB.50.13035">Gonze, X., Charlier, J.-C., Allan, D. C. &amp; Teter, M. P. Interatomic force constants from first principles: The case of Œ±-quartz. Phys. Rev. B 50, 13035‚Äì13038 (1994).</a>&#160;<a class="footnote-backref" href="#fnref-Gonze1994" title="Jump back to footnote 5 in the text">&#8617;</a></p>
</li>
<li id="fn-Gonze1997">
<p><a href="http://link.aps.org/doi/10.1103/PhysRevB.55.10355">Gonze, X. &amp; Lee, C. Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory. Phys. Rev. B 55, 10355‚Äì10368 (1997).</a>&#160;<a class="footnote-backref" href="#fnref-Gonze1997" title="Jump back to footnote 6 in the text">&#8617;</a><a class="footnote-backref" href="#fnref2-Gonze1997" title="Jump back to footnote 6 in the text">&#8617;</a></p>
</li>
</ol>
</div>
    </div>
  </div>

    <br>
    <br>
</div> <!-- /container -->

</div><!-- end of wrapper -->

<div class="footer">
<div class="container"> 
        <br>
        <div class="row">
            <div class="col-md-4">&copy; 2018 </div>
            <div class="col-md-4"><span class="text-center"> TDEP was developed by Olle Hellman & Nina Shulumba</span></div>
            <div class="col-md-4"><span class="pull-right">Documentation generated by <a href="https://github.com/cmacmackin/ford">FORD</a></span></div>
        </div>
        <br>
        <br>
</div>
</div>

    <!-- Bootstrap core JavaScript -->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>
    <!-- MathJax JavaScript -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js'],
            TeX: { 
                extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], 
                equationNumbers: { autoNumber: 'AMS' } 
            },
            jax: ['input/TeX','input/MathML','output/HTML-CSS'],
            tex2jax: {
                inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                processEscapes: true
            },
            'HTML-CSS': { 
                styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: '#000000 ! important'} }
            }
        });
    </script>
    <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>
